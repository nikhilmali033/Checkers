{"ast":null,"code":"import { v4 as uuidv4 } from 'uuid';\nconst sqrCnt = 64;\nexport class Checkers {\n  //black is 0, red is 1\n\n  constructor(board = [], pieces = {}) {\n    this.pieces = {};\n    this.board = [];\n    this.turn = 0;\n    if (board.length === 0) {\n      let sqrs = [];\n      for (let i = 0; i < sqrCnt; i++) {\n        const isBlack = Math.floor(i / 8) % 2 === 0 && i % 8 % 2 === 0 || Math.floor(i / 8) % 2 === 1 && i % 8 % 2 === 1;\n        let obj = {\n          id: i,\n          x: i % 8,\n          y: Math.floor(i / 8),\n          coord: `(${i % 8}, ${Math.floor(i / 8)})`,\n          space_color: isBlack ? 'black' : 'red'\n        };\n        if (obj.y < 3 && isBlack) {\n          obj.piece = this.createPiece(i % 8, Math.floor(i / 8), true);\n        } else if (obj.y > 4 && isBlack) {\n          obj.piece = this.createPiece(i % 8, Math.floor(i / 8), false);\n        }\n        sqrs.push(obj);\n      }\n      this.board = sqrs;\n    } else {\n      this.board = board;\n      this.pieces = pieces;\n    }\n  }\n  createPiece(x, y, isBlack = false) {\n    const id = uuidv4();\n    this.pieces[id] = {\n      id,\n      x,\n      y,\n      isBlack: isBlack,\n      isKing: false\n    };\n    return id;\n  }\n  checkSpace(x, y) {\n    let spaceId = x + y * 8;\n    let pieceId = this.board[spaceId].piece;\n    if (pieceId) return this.pieces[pieceId];\n    return undefined;\n  }\n  getValidMoves(id) {\n    const p = this.pieces[id];\n    let validMoves = new Set();\n    let moveInfo = {};\n    let toCheck = p.isKing ? [{\n      dx: 1,\n      dy: 1\n    }, {\n      dx: -1,\n      dy: -1\n    }, {\n      dx: 1,\n      dy: -1\n    }, {\n      dx: -1,\n      dy: -1\n    }] : p.isBlack ? [{\n      dx: 1,\n      dy: 1\n    }, {\n      dx: -1,\n      dy: 1\n    }] : [{\n      dx: 1,\n      dy: -1\n    }, {\n      dx: -1,\n      dy: -1\n    }];\n    toCheck.forEach(x => {\n      if (p.x + x.dx <= 7 && p.y + x.dy <= 7 && p.x + x.dx >= 0 && p.y + x.dy >= 0) {\n        const check = this.checkSpace(p.x + x.dx, p.y + x.dy);\n        if (check != null) {\n          //If is opponents piece\n          if (check.isBlack !== p.isBlack) {\n            if (p.x + 2 * x.dx <= 7 && p.y + 2 * x.dy <= 7 && p.x + 2 * x.dx >= 0 && p.y + 2 * x.dy >= 0) {\n              //If next diagonal space is empty\n              if (this.checkSpace(p.x + 2 * x.dx, p.y + 2 * x.dy) === undefined) {\n                const move = `(${p.x + 2 * x.dx}, ${p.y + 2 * x.dy})`;\n                validMoves.add(move);\n                moveInfo[move] = {\n                  captures: [check.id]\n                };\n              }\n            }\n          }\n        } else {\n          const move = `(${p.x + x.dx}, ${p.y + x.dy})`;\n          validMoves.add(move);\n          moveInfo[move] = {\n            captures: []\n          };\n        }\n      }\n    });\n    return {\n      validMoves,\n      moveInfo\n    };\n  }\n  movePiece(space, id, info) {\n    const piece = this.pieces[id];\n    const lastSpace = this.board.find(x => x.piece === id);\n    lastSpace.piece = null;\n    const dx = this.board[space].x - lastSpace.x;\n    if (Math.abs(dx) === 2) {\n      const dy = this.board[space].y - lastSpace.y;\n    }\n    this.board[space].piece = id;\n    piece.x = this.board[space].x;\n    piece.y = this.board[space].y;\n    if (piece.isBlack && piece.y === 7) piece.isKing = true;else if (!piece.isBlack && piece.y === 0) piece.isKing = true;\n    this.turn = this.turn === 0 ? 1 : 0;\n    if (info.captures.length !== 0) {\n      info.captures.forEach(x => {\n        const space = this.board.find(s => s.piece === x);\n        if (space) space.piece = null;\n        this.pieces[x].captured = true;\n      });\n    }\n  }\n  pieceTurn(id) {\n    const piece = this.pieces[id];\n    return piece.isBlack && this.turn === 0 || !piece.isBlack && this.turn === 1;\n  }\n}","map":{"version":3,"names":["v4","uuidv4","sqrCnt","Checkers","constructor","board","pieces","turn","length","sqrs","i","isBlack","Math","floor","obj","id","x","y","coord","space_color","piece","createPiece","push","isKing","checkSpace","spaceId","pieceId","undefined","getValidMoves","p","validMoves","Set","moveInfo","toCheck","dx","dy","forEach","check","move","add","captures","movePiece","space","info","lastSpace","find","abs","s","captured","pieceTurn"],"sources":["/Users/mbranni03/Documents/GitHub/Checkers/frontend/src/Game.js"],"sourcesContent":["import { v4 as uuidv4 } from 'uuid';\n\nconst sqrCnt = 64;\nexport class Checkers {\n    pieces = {};\n    board = [];\n    turn = 0; //black is 0, red is 1\n\n    constructor(board = [], pieces = {}) {\n        if (board.length === 0) {\n            let sqrs = [];\n            for (let i = 0; i < sqrCnt; i++) {\n                const isBlack = (Math.floor(i/8) % 2 === 0 && (i % 8) % 2 === 0) || (Math.floor(i/8) % 2 === 1 && (i % 8) % 2 === 1);\n                let obj = {\n                    id: i,\n                    x: i % 8,\n                    y: Math.floor(i / 8),\n                    coord: `(${i % 8}, ${Math.floor(i / 8)})`,\n                    space_color: isBlack ? 'black' : 'red',\n                };\n                if (obj.y < 3 && isBlack) {\n                    obj.piece = this.createPiece(i % 8, Math.floor(i / 8), true);\n                } else if (obj.y > 4 && isBlack) {\n                    obj.piece = this.createPiece(i % 8, Math.floor(i / 8), false);\n                }\n                sqrs.push(obj);\n            }\n            this.board = sqrs;  \n        } else {\n            this.board = board;\n            this.pieces = pieces;\n        }\n    }\n\n    createPiece(x, y, isBlack=false) {\n        const id = uuidv4();\n        this.pieces[id] = {\n          id,\n          x,\n          y,\n          isBlack: isBlack,\n          isKing: false,\n        }\n        return id;\n    }\n\n    checkSpace(x, y) {\n        let spaceId = x + y * 8;\n        let pieceId = this.board[spaceId].piece;\n        if (pieceId)\n            return this.pieces[pieceId];\n        return undefined;\n    }\n    \n    getValidMoves(id) {\n        const p = this.pieces[id];\n        let validMoves = new Set();\n        let moveInfo = {};\n        let toCheck = p.isKing ? [{dx: 1, dy: 1}, {dx: -1, dy: -1}, {dx: 1, dy: -1}, {dx: -1, dy: -1}] : (p.isBlack ? [{dx: 1, dy: 1}, {dx: -1, dy: 1}] : [{dx: 1, dy: -1}, {dx: -1, dy: -1}]);\n        toCheck.forEach((x) => {\n          if (p.x + x.dx <= 7 && p.y + x.dy <= 7 && p.x + x.dx >= 0 && p.y + x.dy  >= 0) {\n            const check = this.checkSpace(p.x + x.dx, p.y + x.dy);\n            if (check != null) {\n                //If is opponents piece\n                if (check.isBlack !== p.isBlack) {\n                    if (p.x + (2 * x.dx) <= 7 && p.y + (2 * x.dy) <= 7 && p.x + (2 * x.dx) >= 0 && p.y + (2 * x.dy) >= 0) {\n                        //If next diagonal space is empty\n                        if (this.checkSpace(p.x + (2 * x.dx), p.y + (2 * x.dy)) === undefined) {\n                            const move = `(${p.x + (2 * x.dx)}, ${p.y + (2 * x.dy)})`;\n                            validMoves.add(move);\n                            moveInfo[move] = {\n                                captures: [check.id],\n                            }\n                        }\n                    }\n                }\n            } else {\n                const move = `(${p.x + x.dx}, ${p.y + x.dy})`;\n                validMoves.add(move);\n                moveInfo[move] = {\n                    captures: []\n                }\n            }\n          }\n        });\n        return {validMoves, moveInfo}\n    }\n\n    movePiece(space, id, info) {\n        const piece = this.pieces[id];\n        const lastSpace = this.board.find((x) => x.piece === id);\n        lastSpace.piece = null;\n        const dx = this.board[space].x - lastSpace.x;\n        if (Math.abs(dx) === 2) {\n            const dy = this.board[space].y - lastSpace.y;\n        }\n        this.board[space].piece = id;\n        piece.x = this.board[space].x;\n        piece.y = this.board[space].y;\n        if (piece.isBlack && piece.y === 7) piece.isKing = true;\n        else if (!piece.isBlack && piece.y === 0) piece.isKing = true;\n        this.turn = this.turn === 0 ? 1 : 0;\n        if (info.captures.length !== 0) {\n            info.captures.forEach((x) => {\n                const space = this.board.find((s) => s.piece === x);\n                if (space) space.piece = null;\n                this.pieces[x].captured = true;\n            });\n        }\n    }\n\n    pieceTurn(id) {\n        const piece = this.pieces[id];\n        return (piece.isBlack && this.turn === 0) || (!piece.isBlack && this.turn === 1);\n    }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}